import{x as _,Z as w,r as y,c as b,l as k,n as v,z as t,i as a,I as l,B,K as n,C,Q as p,V as S,y as T}from"./index-q4EwI4hH.js";import{S as f}from"./sweetalert2.esm.all-B0Dix5B2.js";import{V as A,a as h}from"./VRow-C7vXKiK-.js";import{b as D}from"./VList-D8VvDNKf.js";import{V as I}from"./VDataTable-B2CFxcaJ.js";import{V as N}from"./VRating-CxFj5odT.js";import{V as $}from"./VToolbar-D2186Q7V.js";import{V as z}from"./VContainer-B4fpZdeB.js";import"./ssrBoot-CBMlPZ4l.js";import"./VPagination-CCa077JH.js";const P={class:"text-center"},R={class:"mx-auto"},E={class:"mx-auto"},F={class:"mx-auto"},W={__name:"scores",setup(K){const{apiAuth:u}=T(),m=_(),i=w([]),c=y(""),g=b(()=>[{title:"麵屋名稱",align:"center",key:"store",sortable:!0,width:"100",value:"store.name"},{title:"會員",align:"center",key:"user",sortable:!0,width:"80",value:o=>`${o.user.account} ( ${o.user.name} ) `},{title:"評論圖片",align:"center",key:"image",sortable:!1,width:"150"},{title:"分數",align:"center",key:"star",sortable:!0,width:"30"},{title:"描述",align:"center",key:"depiction",sortable:!1,width:"150"},{title:"新增時間",align:"center",key:"createdAt",sortable:!0,width:"100"},{title:"刪除",align:"center",key:"del",sortable:!1,width:"30"}]);(async()=>{var o,s;try{const{data:e}=await u.get("/score/all");i.push(...e.result)}catch(e){console.error("取得評價列表失敗:"+e),m({text:((s=(o=e==null?void 0:e.response)==null?void 0:o.data)==null?void 0:s.message)||"取得評價列表失敗",snackbarProps:{color:"red",timeout:2e3}})}})();const x=async o=>{var e,d;const s=await f.fire({title:"確定要刪除嗎?",text:"你將不能復原這筆資料",icon:"warning",showCancelButton:!0,confirmButtonText:"刪除",confirmButtonColor:"#E94444",cancelButtonText:"取消",cancelButtonColor:"#999999"});if(console.log("result:",s),s.isConfirmed)try{await u.delete("/score/"+o);const r=i.findIndex(V=>V._id===o);i.splice(r,1),f.fire({title:"已刪除",draggable:!0,showConfirmButton:!1,icon:"success",timer:1500})}catch(r){console.error("刪除失敗:"+r),m({text:((d=(e=r==null?void 0:r.response)==null?void 0:e.data)==null?void 0:d.message)||"刪除失敗",snackbarProps:{color:"red",timeout:2e3}})}};return(o,s)=>(v(),k(z,{class:"h-100","fill-height":"",fluid:""},{default:t(()=>[a(A,{class:"h-100",align:"center"},{default:t(()=>[a(h,{cols:"12"},{default:t(()=>s[1]||(s[1]=[l("h1",{class:"text-center"},"評價管理",-1)])),_:1}),a(D),a(h,{col:"12"},{default:t(()=>[a(I,{headers:g.value,items:i,search:c.value,"filter-keys":["user","store"],"items-per-page":5},{top:t(()=>[a($,null,{default:t(()=>[a(S,{modelValue:c.value,"onUpdate:modelValue":s[0]||(s[0]=e=>c.value=e),class:"mt-5","prepend-inner-icon":"mdi-magnify",variant:"outlined",placeholder:"麵屋/會員名稱搜尋"},null,8,["modelValue"])]),_:1})]),"item.store":t(({item:e})=>[a(p,{class:"mx-auto",src:e.store.image,height:"50",width:"50"},null,8,["src"]),l("p",P,n(e.store.name),1)]),"item.image":t(({value:e})=>[a(p,{class:"mx-auto",src:e,height:"100",width:"100"},null,8,["src"])]),"item.star":t(({value:e})=>[l("span",R,[C(n(e)+" ",1),a(N,{readonly:"",length:"1",size:"18","model-value":"1","active-color":"info"})])]),"item.depiction":t(({value:e})=>[l("span",E,n(e),1)]),"item.createdAt":t(({value:e})=>[l("span",F,n(new Date(e).toLocaleString()),1)]),"item.del":t(({item:e})=>[a(B,{variant:"text",density:"comfortable",icon:"mdi-delete",onClick:d=>x(e._id)},null,8,["onClick"])]),_:2},1032,["headers","items","search"])]),_:1})]),_:1})]),_:1}))}};export{W as default};
